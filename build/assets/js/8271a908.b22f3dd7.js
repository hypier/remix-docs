"use strict";(self.webpackChunkremix_docs=self.webpackChunkremix_docs||[]).push([[5743],{7546:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>t,metadata:()=>l,toc:()=>i});var c=o(4848),r=o(8453);const t={title:"useBlocker"},s="useBlocker",l={id:"hooks/use-blocker",title:"useBlocker",description:"useBlocker \u94a9\u5b50\u5141\u8bb8\u60a8\u963b\u6b62\u7528\u6237\u79bb\u5f00\u5f53\u524d\u9875\u9762\uff0c\u5e76\u5411\u4ed6\u4eec\u5c55\u793a\u81ea\u5b9a\u4e49 UI\uff0c\u4ee5\u4fbf\u786e\u8ba4\u5bfc\u822a\u3002",source:"@site/docs/hooks/use-blocker.md",sourceDirName:"hooks",slug:"/hooks/use-blocker",permalink:"/docs/hooks/use-blocker",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/hooks/use-blocker.md",tags:[],version:"current",frontMatter:{title:"useBlocker"},sidebar:"tutorialSidebar",previous:{title:"useBeforeUnload",permalink:"/docs/hooks/use-before-unload"},next:{title:"useFetcher",permalink:"/docs/hooks/use-fetcher"}},d={},i=[{value:"\u5c5e\u6027",id:"\u5c5e\u6027",level:2},{value:"<code>state</code>",id:"state",level:3},{value:"<code>location</code>",id:"location",level:3},{value:"\u65b9\u6cd5",id:"\u65b9\u6cd5",level:2},{value:"<code>proceed()</code>",id:"proceed",level:3},{value:"<code>reset()</code>",id:"reset",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"useblocker",children:(0,c.jsx)(n.code,{children:"useBlocker"})})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"useBlocker"})," \u94a9\u5b50\u5141\u8bb8\u60a8\u963b\u6b62\u7528\u6237\u79bb\u5f00\u5f53\u524d\u9875\u9762\uff0c\u5e76\u5411\u4ed6\u4eec\u5c55\u793a\u81ea\u5b9a\u4e49 UI\uff0c\u4ee5\u4fbf\u786e\u8ba4\u5bfc\u822a\u3002"]}),"\n",(0,c.jsx)("docs-info",{children:(0,c.jsxs)(n.p,{children:["\u8fd9\u4ec5\u9002\u7528\u4e8e\u60a8 React Router \u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u5ba2\u6237\u7aef\u5bfc\u822a\uff0c\u5e76\u4e0d\u4f1a\u963b\u6b62\u6587\u6863\u8bf7\u6c42\u3002\u8981\u9632\u6b62\u6587\u6863\u5bfc\u822a\uff0c\u60a8\u9700\u8981\u6dfb\u52a0\u81ea\u5df1\u7684 ",(0,c.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event",target:"_blank",children:(0,c.jsx)(n.code,{children:"beforeunload"})})," \u4e8b\u4ef6\u5904\u7406\u7a0b\u5e8f\u3002"]})}),"\n",(0,c.jsx)("docs-warning",{children:(0,c.jsxs)(n.p,{children:["\u963b\u6b62\u7528\u6237\u5bfc\u822a\u6709\u70b9\u53cd\u6a21\u5f0f\uff0c\u56e0\u6b64\u8bf7\u4ed4\u7ec6\u8003\u8651\u6b64\u94a9\u5b50\u7684\u4efb\u4f55\u4f7f\u7528\uff0c\u5e76\u5c3d\u91cf\u5c11\u7528\u3002\u5728\u9632\u6b62\u7528\u6237\u79bb\u5f00\u672a\u586b\u5199\u5b8c\u6574\u8868\u5355\u7684\u5178\u578b\u7528\u4f8b\u4e2d\uff0c\u60a8\u53ef\u4ee5\u8003\u8651\u5c06\u672a\u4fdd\u5b58\u7684\u72b6\u6001\u6301\u4e45\u5316\u5230 ",(0,c.jsx)(n.code,{children:"sessionStorage"})," \u4e2d\uff0c\u5e76\u5728\u4ed6\u4eec\u8fd4\u56de\u65f6\u81ea\u52a8\u91cd\u65b0\u586b\u5145\uff0c\u800c\u4e0d\u662f\u963b\u6b62\u4ed6\u4eec\u79bb\u5f00\u3002"]})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-tsx",children:'function ImportantForm() {\n  const [value, setValue] = React.useState("");\n\n  // Block navigating elsewhere when data has been entered into the input\n  const blocker = useBlocker(\n    ({ currentLocation, nextLocation }) =>\n      value !== "" &&\n      currentLocation.pathname !== nextLocation.pathname\n  );\n\n  return (\n    <Form method="post">\n      <label>\n        Enter some important data:\n        <input\n          name="data"\n          value={value}\n          onChange={(e) => setValue(e.target.value)}\n        />\n      </label>\n      <button type="submit">Save</button>\n\n      {blocker.state === "blocked" ? (\n        <div>\n          <p>Are you sure you want to leave?</p>\n          <button onClick={() => blocker.proceed()}>\n            Proceed\n          </button>\n          <button onClick={() => blocker.reset()}>\n            Cancel\n          </button>\n        </div>\n      ) : null}\n    </Form>\n  );\n}\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u6709\u5173\u66f4\u5b8c\u6574\u7684\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u5b58\u50a8\u5e93\u4e2d\u7684 ",(0,c.jsx)(n.a,{href:"https://github.com/remix-run/react-router/tree/main/examples/navigation-blocking",children:"example"}),"\u3002"]}),"\n",(0,c.jsx)(n.h2,{id:"\u5c5e\u6027",children:"\u5c5e\u6027"}),"\n",(0,c.jsx)(n.h3,{id:"state",children:(0,c.jsx)(n.code,{children:"state"})}),"\n",(0,c.jsx)(n.p,{children:"\u963b\u585e\u5668\u7684\u5f53\u524d\u72b6\u6001"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"unblocked"})," - \u963b\u585e\u5668\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\uff0c\u672a\u963b\u6b62\u4efb\u4f55\u5bfc\u822a"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"blocked"})," - \u963b\u585e\u5668\u5df2\u963b\u6b62\u4e00\u6b21\u5bfc\u822a"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.code,{children:"proceeding"})," - \u963b\u585e\u5668\u6b63\u5728\u4ece\u88ab\u963b\u6b62\u7684\u5bfc\u822a\u4e2d\u7ee7\u7eed\u8fdb\u884c"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"location",children:(0,c.jsx)(n.code,{children:"location"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5f53\u5904\u4e8e ",(0,c.jsx)(n.code,{children:"blocked"})," \u72b6\u6001\u65f6\uff0c\u8fd9\u8868\u793a\u6211\u4eec\u963b\u6b62\u5bfc\u822a\u7684\u5730\u70b9\u3002\u5f53\u5904\u4e8e ",(0,c.jsx)(n.code,{children:"proceeding"})," \u72b6\u6001\u65f6\uff0c\u8fd9\u662f\u5728 ",(0,c.jsx)(n.code,{children:"blocker.proceed()"})," \u8c03\u7528\u540e\u6b63\u5728\u5bfc\u822a\u7684\u5730\u70b9\u3002"]}),"\n",(0,c.jsx)(n.h2,{id:"\u65b9\u6cd5",children:"\u65b9\u6cd5"}),"\n",(0,c.jsx)(n.h3,{id:"proceed",children:(0,c.jsx)(n.code,{children:"proceed()"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5f53\u5904\u4e8e ",(0,c.jsx)(n.code,{children:"blocked"})," \u72b6\u6001\u65f6\uff0c\u60a8\u53ef\u4ee5\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"blocker.proceed()"})," \u4ee5\u7ee7\u7eed\u5230\u88ab\u963b\u585e\u7684\u4f4d\u7f6e\u3002"]}),"\n",(0,c.jsx)(n.h3,{id:"reset",children:(0,c.jsx)(n.code,{children:"reset()"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5f53\u5904\u4e8e ",(0,c.jsx)(n.code,{children:"blocked"})," \u72b6\u6001\u65f6\uff0c\u60a8\u53ef\u4ee5\u8c03\u7528 ",(0,c.jsx)(n.code,{children:"blocker.reset()"})," \u5c06\u963b\u6b62\u5668\u8fd4\u56de\u5230 ",(0,c.jsx)(n.code,{children:"unblocked"})," \u72b6\u6001\uff0c\u5e76\u5c06\u7528\u6237\u4fdd\u7559\u5728\u5f53\u524d\u4f4d\u7f6e\u3002"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>l});var c=o(6540);const r={},t=c.createContext(r);function s(e){const n=c.useContext(t);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),c.createElement(t.Provider,{value:n},e.children)}}}]);