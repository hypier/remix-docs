"use strict";(self.webpackChunkremix_docs=self.webpackChunkremix_docs||[]).push([[717],{8582:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>i,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>s,toc:()=>l});var a=t(4848),n=t(8453);const d={title:"useRevalidator",new:!0},o="useRevalidator",s={id:"hooks/use-revalidator",title:"useRevalidator",description:"\u5728\u6b63\u5e38\u6570\u636e\u53d8\u66f4\u4e4b\u5916\u7684\u539f\u56e0\u4e0b\u91cd\u65b0\u9a8c\u8bc1\u9875\u9762\u4e0a\u7684\u6570\u636e\uff0c\u4f8b\u5982\u7a97\u53e3\u805a\u7126\u6216\u5b9a\u65f6\u8f6e\u8be2\u3002",source:"@site/docs/hooks/use-revalidator.md",sourceDirName:"hooks",slug:"/hooks/use-revalidator",permalink:"/docs/hooks/use-revalidator",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/hooks/use-revalidator.md",tags:[],version:"current",frontMatter:{title:"useRevalidator",new:!0},sidebar:"tutorialSidebar",previous:{title:"useResolvedPath",permalink:"/docs/hooks/use-resolved-path"},next:{title:"useRouteError",permalink:"/docs/hooks/use-route-error"}},i={},l=[{value:"\u5c5e\u6027",id:"\u5c5e\u6027",level:2},{value:"<code>revalidator.state</code>",id:"revalidatorstate",level:3},{value:"<code>revalidator.revalidate()</code>",id:"revalidatorrevalidate",level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:2}];function c(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"userevalidator",children:(0,a.jsx)(r.code,{children:"useRevalidator"})})}),"\n",(0,a.jsx)(r.p,{children:"\u5728\u6b63\u5e38\u6570\u636e\u53d8\u66f4\u4e4b\u5916\u7684\u539f\u56e0\u4e0b\u91cd\u65b0\u9a8c\u8bc1\u9875\u9762\u4e0a\u7684\u6570\u636e\uff0c\u4f8b\u5982\u7a97\u53e3\u805a\u7126\u6216\u5b9a\u65f6\u8f6e\u8be2\u3002"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-tsx",children:'import { useRevalidator } from "@remix-run/react";\n\nfunction WindowFocusRevalidator() {\n  const revalidator = useRevalidator();\n\n  useFakeWindowFocus(() => {\n    revalidator.revalidate();\n  });\n\n  return (\n    <div hidden={revalidator.state === "idle"}>\n      \u6b63\u5728\u91cd\u65b0\u9a8c\u8bc1...\n    </div>\n  );\n}\n'})}),"\n",(0,a.jsxs)(r.p,{children:["\u5f53\u8c03\u7528\u64cd\u4f5c\u65f6\uff0cRemix \u5df2\u7ecf\u4f1a\u81ea\u52a8\u91cd\u65b0\u9a8c\u8bc1\u9875\u9762\u4e0a\u7684\u6570\u636e\u3002\u5982\u679c\u60a8\u53d1\u73b0\u81ea\u5df1\u5728\u54cd\u5e94\u7528\u6237\u4ea4\u4e92\u65f6\u4f7f\u7528\u6b64\u529f\u80fd\u8fdb\u884c\u6b63\u5e38\u7684 CRUD \u64cd\u4f5c\uff0c\u90a3\u4e48\u60a8\u53ef\u80fd\u6ca1\u6709\u5145\u5206\u5229\u7528\u5176\u4ed6 API\uff0c\u4f8b\u5982 ",(0,a.jsx)(r.a,{href:"../components/form",children:(0,a.jsx)(r.code,{children:"<Form>"})}),"\u3001",(0,a.jsx)(r.a,{href:"./use-submit",children:(0,a.jsx)(r.code,{children:"useSubmit"})})," \u6216 ",(0,a.jsx)(r.a,{href:"./use-fetcher",children:(0,a.jsx)(r.code,{children:"useFetcher"})}),"\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u662f\u81ea\u52a8\u5b8c\u6210\u7684\u3002"]}),"\n",(0,a.jsx)(r.h2,{id:"\u5c5e\u6027",children:"\u5c5e\u6027"}),"\n",(0,a.jsx)(r.h3,{id:"revalidatorstate",children:(0,a.jsx)(r.code,{children:"revalidator.state"})}),"\n",(0,a.jsxs)(r.p,{children:["\u91cd\u65b0\u9a8c\u8bc1\u7684\u72b6\u6001\u3002\u53ef\u4ee5\u662f ",(0,a.jsx)(r.code,{children:'"idle"'})," \u6216 ",(0,a.jsx)(r.code,{children:'"loading"'}),"\u3002"]}),"\n",(0,a.jsx)(r.h3,{id:"revalidatorrevalidate",children:(0,a.jsx)(r.code,{children:"revalidator.revalidate()"})}),"\n",(0,a.jsx)(r.p,{children:"\u542f\u52a8\u91cd\u65b0\u9a8c\u8bc1\u3002"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-tsx",children:'function useLivePageData() {\n  const revalidator = useRevalidator();\n  const interval = useInterval(5000);\n\n  useEffect(() => {\n    if (revalidator.state === "idle") {\n      revalidator.revalidate();\n    }\n  }, [interval, revalidator]);\n}\n'})}),"\n",(0,a.jsx)(r.h2,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,a.jsxs)(r.p,{children:["\u867d\u7136\u60a8\u53ef\u4ee5\u540c\u65f6\u6e32\u67d3\u591a\u4e2a ",(0,a.jsx)(r.code,{children:"useRevalidator"})," \u7684\u5b9e\u4f8b\uff0c\u4f46\u5176\u5e95\u5c42\u662f\u4e00\u4e2a\u5355\u4f8b\u3002\u8fd9\u610f\u5473\u7740\u5f53\u8c03\u7528\u4e00\u4e2a ",(0,a.jsx)(r.code,{children:"revalidator.revalidate()"})," \u65f6\uff0c\u6240\u6709\u5b9e\u4f8b\u90fd\u4f1a\u4e00\u8d77\u8fdb\u5165 ",(0,a.jsx)(r.code,{children:'"loading"'})," \u72b6\u6001\uff08\u6216\u8005\u8bf4\uff0c\u5b83\u4eec\u90fd\u4f1a\u66f4\u65b0\u4ee5\u62a5\u544a\u5355\u4f8b\u72b6\u6001\uff09\u3002"]}),"\n",(0,a.jsxs)(r.p,{children:["\u5f53\u8c03\u7528 ",(0,a.jsx)(r.code,{children:"revalidate()"})," \u65f6\uff0c\u5982\u679c\u7531\u4e8e\u5176\u4ed6\u539f\u56e0\u5df2\u7ecf\u5728\u8fdb\u884c\u91cd\u65b0\u9a8c\u8bc1\uff0c\u5219\u4f1a\u81ea\u52a8\u5904\u7406\u7ade\u4e89\u6761\u4ef6\u3002"]}),"\n",(0,a.jsx)(r.p,{children:"\u5982\u679c\u5728\u91cd\u65b0\u9a8c\u8bc1\u8fdb\u884c\u4e2d\u53d1\u751f\u5bfc\u822a\uff0c\u91cd\u65b0\u9a8c\u8bc1\u5c06\u88ab\u53d6\u6d88\uff0c\u5e76\u5c06\u4ece\u6240\u6709\u52a0\u8f7d\u5668\u8bf7\u6c42\u4e0b\u4e00\u9875\u7684\u65b0\u6570\u636e\u3002"})]})}function u(e={}){const{wrapper:r}={...(0,n.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,r,t)=>{t.d(r,{R:()=>o,x:()=>s});var a=t(6540);const n={},d=a.createContext(n);function o(e){const r=a.useContext(d);return a.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function s(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),a.createElement(d.Provider,{value:r},e.children)}}}]);