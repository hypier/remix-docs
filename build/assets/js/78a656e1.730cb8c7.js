"use strict";(self.webpackChunkremix_docs=self.webpackChunkremix_docs||[]).push([[1812],{1847:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>a,frontMatter:()=>t,metadata:()=>d,toc:()=>l});var s=r(4848),i=r(8453);const t={title:"\u9884\u8bbe"},o="\u9884\u8bbe",d={id:"guides/presets",title:"\u9884\u8bbe",description:"Remix Vite \u63d2\u4ef6 \u652f\u6301 presets \u9009\u9879\uff0c\u4ee5\u4fbf\u4e0e\u5176\u4ed6\u5de5\u5177\u548c\u6258\u7ba1\u63d0\u4f9b\u5546\u7684\u96c6\u6210\u66f4\u52a0\u7b80\u4fbf\u3002",source:"@site/docs/guides/presets.md",sourceDirName:"guides",slug:"/guides/presets",permalink:"/docs/guides/presets",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/guides/presets.md",tags:[],version:"current",frontMatter:{title:"\u9884\u8bbe"},sidebar:"tutorialSidebar",previous:{title:"\u6027\u80fd",permalink:"/docs/guides/performance"},next:{title:"\u6e10\u8fdb\u589e\u5f3a",permalink:"/docs/guides/progressive-enhancement"}},c={},l=[{value:"\u521b\u5efa\u9884\u8bbe",id:"\u521b\u5efa\u9884\u8bbe",level:2},{value:"\u5b9a\u4e49\u9884\u8bbe\u914d\u7f6e",id:"\u5b9a\u4e49\u9884\u8bbe\u914d\u7f6e",level:3},{value:"\u9a8c\u8bc1\u914d\u7f6e",id:"\u9a8c\u8bc1\u914d\u7f6e",level:3},{value:"\u4f7f\u7528\u9884\u8bbe",id:"\u4f7f\u7528\u9884\u8bbe",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u9884\u8bbe",children:"\u9884\u8bbe"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"./vite",children:"Remix Vite \u63d2\u4ef6"})," \u652f\u6301 ",(0,s.jsx)(n.code,{children:"presets"})," \u9009\u9879\uff0c\u4ee5\u4fbf\u4e0e\u5176\u4ed6\u5de5\u5177\u548c\u6258\u7ba1\u63d0\u4f9b\u5546\u7684\u96c6\u6210\u66f4\u52a0\u7b80\u4fbf\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u9884\u8bbe\u53ea\u80fd\u505a\u4e24\u4ef6\u4e8b\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4ee3\u8868\u60a8\u914d\u7f6e Remix Vite \u63d2\u4ef6\u3002"}),"\n",(0,s.jsx)(n.li,{children:"\u9a8c\u8bc1\u89e3\u6790\u7684\u914d\u7f6e\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u6bcf\u4e2a\u9884\u8bbe\u8fd4\u56de\u7684\u914d\u7f6e\u6309\u7167\u5b9a\u4e49\u7684\u987a\u5e8f\u5408\u5e76\u3002\u4efb\u4f55\u76f4\u63a5\u4f20\u9012\u7ed9 Remix Vite \u63d2\u4ef6\u7684\u914d\u7f6e\u5c06\u6700\u540e\u5408\u5e76\u3002\u8fd9\u610f\u5473\u7740\u7528\u6237\u914d\u7f6e\u5c06\u59cb\u7ec8\u4f18\u5148\u4e8e\u4efb\u4f55\u9884\u8bbe\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u521b\u5efa\u9884\u8bbe",children:"\u521b\u5efa\u9884\u8bbe"}),"\n",(0,s.jsxs)(n.p,{children:["\u9884\u8bbe\u7b26\u5408\u4ee5\u4e0b ",(0,s.jsx)(n.code,{children:"Preset"})," \u7c7b\u578b\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"type Preset = {\n  name: string;\n\n  remixConfig?: (args: {\n    remixUserConfig: VitePluginConfig;\n  }) => RemixConfigPreset | Promise<RemixConfigPreset>;\n\n  remixConfigResolved?: (args: {\n    remixConfig: ResolvedVitePluginConfig;\n  }) => void | Promise<void>;\n};\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u5b9a\u4e49\u9884\u8bbe\u914d\u7f6e",children:"\u5b9a\u4e49\u9884\u8bbe\u914d\u7f6e"}),"\n",(0,s.jsxs)(n.p,{children:["\u4f5c\u4e3a\u4e00\u4e2a\u57fa\u672c\u793a\u4f8b\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e ",(0,s.jsx)(n.a,{href:"./server-bundles",children:"server bundles function"})," \u7684\u9884\u8bbe\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:"filename=my-cool-preset.ts",children:'import type { Preset } from "@remix-run/dev";\n\nexport function myCoolPreset(): Preset {\n  return {\n    name: "my-cool-preset",\n    remixConfig: () => ({\n      serverBundles: ({ branch }) => {\n        const isAuthenticatedRoute = branch.some((route) =>\n          route.id.split("/").includes("_authenticated")\n        );\n\n        return isAuthenticatedRoute\n          ? "authenticated"\n          : "unauthenticated";\n      },\n    }),\n  };\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u9a8c\u8bc1\u914d\u7f6e",children:"\u9a8c\u8bc1\u914d\u7f6e"}),"\n",(0,s.jsx)(n.p,{children:"\u91cd\u8981\u7684\u662f\u8981\u8bb0\u4f4f\uff0c\u5176\u4ed6\u9884\u8bbe\u548c\u7528\u6237\u914d\u7f6e\u4ecd\u7136\u53ef\u4ee5\u8986\u76d6\u4ece\u60a8\u7684\u9884\u8bbe\u8fd4\u56de\u7684\u503c\u3002"}),"\n",(0,s.jsxs)(n.p,{children:["\u5728\u6211\u4eec\u7684\u793a\u4f8b\u9884\u8bbe\u4e2d\uff0c",(0,s.jsx)(n.code,{children:"serverBundles"})," \u51fd\u6570\u53ef\u80fd\u4f1a\u88ab\u4e0d\u540c\u7684\u3001\u51b2\u7a81\u7684\u5b9e\u73b0\u8986\u76d6\u3002\u5982\u679c\u6211\u4eec\u60f3\u9a8c\u8bc1\u6700\u7ec8\u89e3\u6790\u7684\u914d\u7f6e\u662f\u5426\u5305\u542b\u6211\u4eec\u9884\u8bbe\u7684 ",(0,s.jsx)(n.code,{children:"serverBundles"})," \u51fd\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"remixConfigResolved"})," \u94a9\u5b50\u6765\u5b9e\u73b0\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:"filename=my-cool-preset.ts lines=[22-26]",children:'import type {\n  Preset,\n  ServerBundlesFunction,\n} from "@remix-run/dev";\n\nconst serverBundles: ServerBundlesFunction = ({\n  branch,\n}) => {\n  const isAuthenticatedRoute = branch.some((route) =>\n    route.id.split("/").includes("_authenticated")\n  );\n\n  return isAuthenticatedRoute\n    ? "authenticated"\n    : "unauthenticated";\n};\n\nexport function myCoolPreset(): Preset {\n  return {\n    name: "my-cool-preset",\n    remixConfig: () => ({ serverBundles }),\n    remixConfigResolved: ({ remixConfig }) => {\n      if (remixConfig.serverBundles !== serverBundles) {\n        throw new Error("`serverBundles` was overridden!");\n      }\n    },\n  };\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"remixConfigResolved"})," \u94a9\u5b50\u5e94\u4ec5\u5728\u5408\u5e76\u6216\u8986\u76d6\u60a8\u7684\u9884\u8bbe\u914d\u7f6e\u4f1a\u5bfc\u81f4\u9519\u8bef\u7684\u60c5\u51b5\u4e0b\u4f7f\u7528\u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u4f7f\u7528\u9884\u8bbe",children:"\u4f7f\u7528\u9884\u8bbe"}),"\n",(0,s.jsx)(n.p,{children:"\u9884\u8bbe\u65e8\u5728\u53d1\u5e03\u5230 npm \u5e76\u5728\u60a8\u7684 Vite \u914d\u7f6e\u4e2d\u4f7f\u7528\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:"filename=vite.config.ts lines=[3,8]",children:'import { vitePlugin as remix } from "@remix-run/dev";\nimport { myCoolPreset } from "remix-preset-cool";\nimport { defineConfig } from "vite";\n\nexport default defineConfig({\n  plugins: [\n    remix({\n      presets: [myCoolPreset()],\n    }),\n  ],\n});\n'})})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var s=r(6540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);